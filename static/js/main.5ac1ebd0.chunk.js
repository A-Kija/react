(this.webpackJsonpone=this.webpackJsonpone||[]).push([[0],{34:function(e,t,c){},35:function(e,t,c){},60:function(e,t,c){"use strict";c.r(t);var a=c(1),n=c.n(a),s=c(28),i=c.n(s),o=(c(34),c(9)),r=(c(35),"SORT_PRICE_UP"),l="SORT_PRICE_DOWN",j="GET_BOOKS_FROM_SERVER",d="UPDATE_BOOKS_FROM_SERVER",u="CHANGE_ITEMS_PER_PAGE",b="SET_ACTIVE_PAGE",O="GET_NEWS_FROM_SERVER",p="ADD_PRODUCT_FROM_SERVER",h=c(62),g=Object(a.createContext)(localStorage.getItem("bookTypes")?JSON.parse(localStorage.getItem("bookTypes")):[]),v=c(0),f=function(){return Object(v.jsxs)("div",{className:"lds-ellipsis",children:[Object(v.jsx)("div",{}),Object(v.jsx)("div",{}),Object(v.jsx)("div",{}),Object(v.jsx)("div",{})]})},x=function(e){var t=e.type,c=Object(a.useContext)(g).filter((function(e){return e.id===t}));return c.length?Object(v.jsx)("div",{className:"cat",children:c[0].title}):Object(v.jsx)(f,{})},P=function(e){var t=e.book;return Object(v.jsx)("li",{children:Object(v.jsxs)("div",{className:"content",children:[Object(v.jsx)("div",{className:"title",children:t.title}),Object(v.jsx)("div",{className:"author",children:t.author}),Object(v.jsx)("div",{className:"img",children:Object(v.jsx)("img",{src:t.img,alt:t.title})}),Object(v.jsxs)("div",{className:"price",children:[t.price," EUR"]}),Object(v.jsx)(x,{type:t.type})]})})},m=function(e){var t=e.books;return Object(v.jsx)("ul",{className:"books-list",children:t.map((function(e){return Object(v.jsx)(P,{book:e},Object(h.a)())}))})},y=c(14),k=c.n(y),S=k.a.create({baseURL:"https://in3.dev/knygos/"}),B=k.a.create({baseURL:"https://in3.dev/vinted/api/"}),E=function(e,t){var c;switch(t.type){case r:return c=e.allBooks.sort((function(e,t){return e.price>t.price?1:-1})),{showBooks:[].concat(c).slice((e.activePage-1)*t.payload.itemsPerPage,e.activePage*t.payload.itemsPerPage),allBooks:c,activePage:e.activePage};case l:return c=e.allBooks.sort((function(e,t){return e.price<t.price?1:-1})),{showBooks:[].concat(c).slice((e.activePage-1)*t.payload.itemsPerPage,e.activePage*t.payload.itemsPerPage),allBooks:c,activePage:e.activePage};case j:return{showBooks:t.payload.allBooks.slice(0,t.payload.itemsPerPage),allBooks:t.payload.allBooks,activePage:1};case d:var a=e.allBooks.concat(t.payload.updatedBooks);return console.log(a),e;case u:return{showBooks:[].concat(e.allBooks).slice(0,t.payload.itemsPerPage),allBooks:e.allBooks,activePage:1};case b:return{showBooks:[].concat(e.allBooks).slice((t.payload.activePage-1)*t.payload.itemsPerPage,t.payload.activePage*t.payload.itemsPerPage),allBooks:e.allBooks,activePage:t.payload.activePage};default:return e}},N=function(e){var t=e.handleTypeSelect,c=e.typeSelectValue,n=Object(a.useContext)(g);return Object(v.jsx)("div",{className:"selector-box",children:Object(v.jsxs)("select",{onChange:t,value:c,children:[Object(v.jsx)("option",{value:"0",children:"Select type"}),n.map((function(e){return Object(v.jsx)("option",{value:e.id,children:e.title},e.id)}))]})})},w=c(13),_=c(10),R=function(e){var t=e.handlePageSelect,c=e.page;return Object(v.jsx)("span",{onClick:function(){return t(c+1)},children:c+1})},I=function(){return Object(v.jsx)("span",{children:"..."})},T=function(e){return function(t){var c=t.page+1;return c===t.activePage+2&&c!==t.allPages||c===t.activePage-2&&1!==c?Object(v.jsx)(I,Object(_.a)({},t)):Object(v.jsx)(e,Object(_.a)({},t))}}(function(e){return function(t){return t.activePage===t.page+1?Object(v.jsx)(R,Object(_.a)({},t)):Object(v.jsx)(e,Object(_.a)({},t))}}(function(e){return function(t){var c=t.page+1;return c===t.activePage+2||c===t.activePage-2||c===t.activePage+1||c===t.activePage-1||c===t.activePage||1===c||c===t.allPages?Object(v.jsx)(e,Object(_.a)({},t)):null}}((function(e){var t=e.handlePageSelect,c=e.page;return Object(v.jsx)("span",{onClick:function(){return t(c+1)},children:Object(v.jsx)("a",{href:"#",children:c+1})})})))),C=function(e){var t=e.itemsPerPage,c=e.allItemsCount,a=e.handlePageSelect,n=e.activePage,s=(e.allPages,Array(Math.ceil(c/t)).fill(null));return Object(v.jsx)("div",{className:"pager",children:s.map((function(e,t){var c;return Object(v.jsx)(T,(c={handlePageSelect:a,page:t,allPages:s},Object(w.a)(c,"allPages",s.length),Object(w.a)(c,"activePage",n),c),t+1)}))})},D=function(e,t){switch(t.type){case O:return{news:t.payload,products:e.products};case p:var c=[].concat(e.products);return c.push(t.payload),{news:e.news,products:c};default:return e}},A=c(8),M=function(e){var t=e.productId,c=e.vintedDispatch,n=e.vinted;if(Object(a.useEffect)((function(){B.get("products/"+t).then((function(e){c({type:p,payload:e.data})})).catch((function(e){}))}),[t]),n.products.filter((function(e){return e.id===t})).length){var s=n.products.filter((function(e){return e.id===t}))[0];return Object(v.jsx)("li",{children:Object(v.jsx)(A.b,{to:"show-product/".concat(t),children:Object(v.jsxs)("div",{className:"content",children:[Object(v.jsx)("div",{className:"title",children:s.title}),Object(v.jsx)("div",{className:"img",children:Object(v.jsx)("img",{src:s.img[s.main_img],alt:s.title})})]})})})}return Object(v.jsx)("li",{children:Object(v.jsx)("div",{className:"content",children:Object(v.jsx)(f,{})})})},U=function(e){var t=e.vinted,c=e.vintedDispatch;return Object(v.jsx)("ul",{className:"books-list",children:t.news.map((function(e){return Object(v.jsx)(M,{productId:e.id,vinted:t,vintedDispatch:c},e.id)}))})},V=c(2),G=function(e){var t=e.vinted,c=Object(V.h)().id,a=t.products.find((function(e){return e.id===parseInt(c)}));return Object(v.jsxs)("div",{className:"full-product",children:[Object(v.jsx)("h2",{children:a.title}),a.img.map((function(e){return Object(v.jsx)("img",{src:e},e)})),Object(v.jsx)("div",{className:"product-desc",children:a.desc})]})},F=function(){var e=Object(V.g)().pathname,t=Object(a.useState)(0),c=Object(o.a)(t,2),n=c[0],s=c[1],i=Object(V.f)(),r=Object(V.i)("/books/:page");return console.log(r),Object(a.useEffect)((function(){s((function(e){return e+1}))}),[e]),r?(r.params.page>8&&i.replace("/books/".concat(8)),Object(v.jsxs)("div",{children:[Object(v.jsxs)("h1",{children:["BOOKS PAGE ",r.params.page]}),Object(v.jsxs)("div",{children:[" Browsing in: ",e," "]}),Object(v.jsxs)("div",{children:[" Page view count: ",n]})]})):Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{children:[" Browsing in: ",e," "]}),Object(v.jsxs)("div",{children:[" Page view count: ",n]})]})};var J=function(){var e=Object(a.useReducer)(E,{showBooks:[],allBooks:[],activePage:1}),t=Object(o.a)(e,2),c=t[0],n=t[1],s=Object(a.useState)(Object(a.useContext)(g)),i=Object(o.a)(s,2),p=i[0],h=i[1],f=Object(a.useState)(0),x=Object(o.a)(f,2),P=x[0],y=x[1],k=Object(a.useState)(3),w=Object(o.a)(k,2),_=w[0],R=(w[1],Object(a.useState)(Date.now())),I=Object(o.a)(R,2),T=I[0],M=I[1];Object(a.useEffect)((function(){S.post("",{time:Math.round(T/1e3)-10}).then((function(e){n({type:d,payload:{updatedBooks:e.data,itemsPerPage:_}}),console.log(e.data)})).catch((function(e){})),console.log(T)}),[T]),Object(a.useEffect)((function(){var e=setInterval((function(){return M(Date.now())}),1e4);return function(){clearInterval(e)}}),[]);var J=Object(a.useReducer)(D,{news:[],products:[]}),K=Object(o.a)(J,2),H=K[0],L=K[1];return Object(a.useEffect)((function(){B.get("news/").then((function(e){console.log(e.data),L({type:O,payload:e.data})})).catch((function(e){}))}),[]),Object(a.useEffect)((function(){S.get("").then((function(e){console.log(e.data),n({type:j,payload:{allBooks:e.data,itemsPerPage:_}})})).catch((function(e){}))}),[_]),Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("bookTypes"));console.log("bookTypes",e),e||S.get("/types/").then((function(e){h(e.data),localStorage.setItem("bookTypes",JSON.stringify(e.data))})).catch((function(e){}))}),[]),Object(a.useEffect)((function(){n({type:u,payload:{itemsPerPage:_}})}),[_]),Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(A.a,{basename:"react",children:Object(v.jsxs)(g.Provider,{value:p,children:[Object(v.jsxs)("header",{className:"App-header",children:[Object(v.jsx)(A.b,{to:"/",children:Object(v.jsx)("span",{children:"Home"})}),Object(v.jsx)(A.b,{to:"/books",children:Object(v.jsx)("span",{children:"Books Store"})}),Object(v.jsx)(A.b,{to:"/show-vinted",children:Object(v.jsx)("i",{children:"Show Vinted"})}),Object(v.jsxs)("div",{className:"buttons-holder",children:[Object(v.jsx)(N,{handleTypeSelect:function(e){y(parseInt(e.target.value)),n({type:"FILTER_BOOKS_BY_TYPE",payload:{value:parseInt(e.target.value)}})},typeSelectValue:P}),Object(v.jsx)("button",{className:"filter",children:"Apply filter"}),Object(v.jsx)("button",{className:"sort",onClick:function(){return n({type:r,payload:{itemsPerPage:_}})},children:"Sort by price UP"}),Object(v.jsx)("button",{className:"sort",onClick:function(){return n({type:l,payload:{itemsPerPage:_}})},children:"Sort by price DOWN"})]})]}),Object(v.jsx)(F,{}),Object(v.jsxs)(V.c,{children:[Object(v.jsx)(V.a,{path:"/books",children:Object(v.jsxs)("main",{children:[Object(v.jsx)(m,{books:c.showBooks}),Object(v.jsx)(C,{activePage:c.activePage,handlePageSelect:function(e){console.log(e),n({type:b,payload:{activePage:e,itemsPerPage:_}})},itemsPerPage:_,allItemsCount:c.allBooks.length})]})}),Object(v.jsx)(V.a,{path:"/show-vinted",children:Object(v.jsx)("main",{children:Object(v.jsx)(U,{vinted:H,vintedDispatch:L})})}),Object(v.jsx)(V.a,{path:"/show-product/:id",children:Object(v.jsx)("main",{children:Object(v.jsx)(G,{vinted:H})})}),Object(v.jsx)(V.a,{exact:!0,path:"/",children:"Home sweet home"}),Object(v.jsx)(V.a,{path:"*",children:"404 PAGE NOT FOUND"})]}),Object(v.jsx)("footer",{})]})})})};i.a.render(Object(v.jsx)(n.a.StrictMode,{children:Object(v.jsx)(J,{})}),document.getElementById("root"))}},[[60,1,2]]]);
//# sourceMappingURL=main.5ac1ebd0.chunk.js.map